<form *ngIf="perfil != null" fxLayout="column" [formGroup]="perfilForm"
      (submit)="perfilForm.valid ? atualizaPerfil() : null">
  <mat-card>
    <mat-card-header>
      <h3 style="margin-bottom: 5px; margin-top: 0px">Dados do Perfil</h3>
    </mat-card-header>
    <mat-card-content>
      <div fxLayout="column" fxLayoutAlign="start" fxFlex="100">
        <div fxLayout="row wrap" fxLayoutAlign="space-between center" fxFlex="100">
          <div fxLayout="row wrap" fxLayoutAlign="space-between center" fxFlex="50">
            <app-input [focus]="true" [label]="'Nome'" [parentControl]="perfilForm.get('nome')" [required]="true"
                       [icon]="'group'" fxFlex="70">
            </app-input>

            <mat-form-field appearance="outline" fxFlex="28">
              <mat-label>Cargo</mat-label>

              <mat-select (selectionChange)="findPerfilRecurso($event)" formControlName="roleId">
                <mat-option value="ROLE_ADMIN">Admin</mat-option>
                <mat-option value="ROLE_VIGILANCIA">Vigilância</mat-option>
                <mat-option value="ROLE_EMPRESA">Empresa</mat-option>
              </mat-select>

              <mat-error *ngIf="perfilForm.get('roleId').hasError('required')">
                Tipo de cargo é <b>obrigatório</b>
              </mat-error>
            </mat-form-field>
          </div>
        </div>

        <div *ngIf="dataSource != null && dataSource.length > 0" fxFlex="100" fxLayout="column">
          <h2>Recursos</h2>

          <table mat-table [dataSource]="dataSource" class="mat-elevation-z4" fxFlex="100">
            <ng-container matColumnDef="descricao">
              <th mat-header-cell *matHeaderCellDef>Recurso</th>
              <td mat-cell *matCellDef="let element">
                {{ element.recurso.descricao }}
              </td>
            </ng-container>

            <ng-container matColumnDef="registrar">
              <th mat-header-cell *matHeaderCellDef>Registrar</th>
              <td mat-cell *matCellDef="let element">
                <mat-slide-toggle [ngModelOptions]="{ standalone: true }" [(ngModel)]="element.registrar"
                                  [checked]="element.registrar" [disabled]="disabled">
                </mat-slide-toggle>
              </td>
            </ng-container>

            <ng-container matColumnDef="deletar">
              <th mat-header-cell *matHeaderCellDef>Deletar</th>
              <td mat-cell *matCellDef="let element">
                <mat-slide-toggle [ngModelOptions]="{ standalone: true }" [(ngModel)]="element.deletar"
                                  [checked]="element.deletar" [disabled]="disabled">
                </mat-slide-toggle>
              </td>
            </ng-container>

            <ng-container matColumnDef="atualizar">
              <th mat-header-cell *matHeaderCellDef>Atualizar</th>
              <td mat-cell *matCellDef="let element">
                <mat-slide-toggle [ngModelOptions]="{ standalone: true }" [(ngModel)]="element.atualizar"
                                  [checked]="element.atualizar" [disabled]="disabled">
                </mat-slide-toggle>
              </td>
            </ng-container>

            <ng-container matColumnDef="imprimir">
              <th mat-header-cell *matHeaderCellDef>Imprimir</th>
              <td mat-cell *matCellDef="let element">
                <mat-slide-toggle [ngModelOptions]="{ standalone: true }" [(ngModel)]="element.imprimir"
                                  [checked]="element.imprimir" [disabled]="disabled">
                </mat-slide-toggle>
              </td>
            </ng-container>

            <ng-container matColumnDef="acessar">
              <th mat-header-cell *matHeaderCellDef>Acessar</th>
              <td mat-cell *matCellDef="let element">
                <mat-slide-toggle [ngModelOptions]="{ standalone: true }" [(ngModel)]="element.acessar"
                                  [checked]="element.acessar" [disabled]="disabled">
                </mat-slide-toggle>
              </td>
            </ng-container>

            <ng-container matColumnDef="principal">
              <th mat-header-cell *matHeaderCellDef>Principal</th>
              <td mat-cell *matCellDef="let element">
                <mat-slide-toggle [ngModelOptions]="{ standalone: true }" [(ngModel)]="element.principal"
                                  [checked]="element.principal" [disabled]="disabled">
                </mat-slide-toggle>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <div class="panel-buttons">
    <app-cancel-button (click)="cancel()"></app-cancel-button>
    <app-update-button [submitted]="submitted"></app-update-button>
  </div>
</form>
